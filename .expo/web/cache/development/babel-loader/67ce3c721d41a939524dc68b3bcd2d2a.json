{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/Bhavesh/Developer/AI_CAMP/ai-on-thumbs/screens/Try.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Background from \"../components/Background\";\nimport Logo from \"../components/Logo\";\nimport Header from \"../components/Header\";\nimport FootPrint from \"../components/FootPrint\";\nimport ActionButton from \"../components/ActionButton\";\nimport { AntDesign } from '@expo/vector-icons';\nimport { Camera } from 'expo-camera';\nimport Toast from \"../components/Toast\";\nimport * as FileSystem from 'expo-file-system';\n\nvar axios = require(\"axios\");\n\nimport * as MediaLibrary from 'expo-media-library';\nimport * as Permissions from 'expo-permissions';\nimport { manipulateAsync, SaveFormat } from 'expo-image-manipulator';\nexport default function Try(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasPermission = _useState2[0],\n      setHasPermission = _useState2[1];\n\n  var _useState3 = useState(Camera.Constants.Type.back),\n      _useState4 = _slicedToArray(_useState3, 2),\n      type = _useState4[0],\n      setType = _useState4[1];\n\n  var _useState5 = useState({\n    value: '',\n    type: ''\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      toast = _useState6[0],\n      setToast = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      startCamera = _useState8[0],\n      setStartCamera = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      imageBase64 = _useState10[0],\n      setImageBase64 = _useState10[1];\n\n  var camera = useRef(null);\n\n  var _useState11 = useState(true),\n      _useState12 = _slicedToArray(_useState11, 2),\n      loading = _useState12[0],\n      setLoading = _useState12[1];\n\n  var onUpload = function onUpload(text) {\n    var data;\n    return _regeneratorRuntime.async(function onUpload$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(sendFaceRequest(text));\n\n          case 2:\n            data = _context.sent;\n            setImageBase64(data);\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var compressImage = function compressImage(uri) {\n    var format,\n        result,\n        _args2 = arguments;\n    return _regeneratorRuntime.async(function compressImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            format = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : SaveFormat.JPEG;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(manipulateAsync(uri, [{\n              resize: {\n                width: 250\n              }\n            }], {\n              compress: 0.7,\n              format: format\n            }));\n\n          case 3:\n            result = _context2.sent;\n            return _context2.abrupt(\"return\", result.uri);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var sendFaceRequest = function sendFaceRequest(image_string) {\n    var res, data;\n    return _regeneratorRuntime.async(function sendFaceRequest$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(fetch(\"https://rohanjoshi2.herokuapp.com/image\", {\n              method: 'POST',\n              body: JSON.stringify({\n                base_64: image_string\n              }),\n              headers: {\n                'Content-type': 'application/json'\n              }\n            }));\n\n          case 3:\n            res = _context3.sent;\n            _context3.next = 9;\n            break;\n\n          case 6:\n            _context3.prev = 6;\n            _context3.t0 = _context3[\"catch\"](0);\n            console.log(error.response.data);\n\n          case 9:\n            _context3.next = 11;\n            return _regeneratorRuntime.awrap(res.text());\n\n          case 11:\n            data = _context3.sent;\n            return _context3.abrupt(\"return\", data);\n\n          case 13:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  };\n\n  useEffect(function () {\n    (function _callee() {\n      var _await$Camera$request, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(Camera.requestPermissionsAsync());\n\n            case 2:\n              _await$Camera$request = _context4.sent;\n              status = _await$Camera$request.status;\n              setHasPermission(status === 'granted');\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  if (hasPermission === null) {\n    return React.createElement(Background, {\n      style: {\n        justifyContent: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 16\n      }\n    }, React.createElement(ActivityIndicator, {\n      size: 100,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 62\n      }\n    }));\n  }\n\n  function openCamera() {\n    setStartCamera(true);\n  }\n\n  function takePhoto() {\n    var photo;\n    return _regeneratorRuntime.async(function takePhoto$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            if (camera.current) {\n              _context6.next = 2;\n              break;\n            }\n\n            return _context6.abrupt(\"return\", null);\n\n          case 2:\n            _context6.next = 4;\n            return _regeneratorRuntime.awrap(camera.current.takePictureAsync().then(function _callee2(photo) {\n              var uri, base64;\n              return _regeneratorRuntime.async(function _callee2$(_context5) {\n                while (1) {\n                  switch (_context5.prev = _context5.next) {\n                    case 0:\n                      setStartCamera(false);\n                      _context5.next = 3;\n                      return _regeneratorRuntime.awrap(compressImage(photo.uri));\n\n                    case 3:\n                      uri = _context5.sent;\n                      _context5.next = 6;\n                      return _regeneratorRuntime.awrap(FileSystem.readAsStringAsync(uri, {\n                        encoding: 'base64'\n                      }));\n\n                    case 6:\n                      base64 = _context5.sent;\n                      console.log(base64.length);\n                      _context5.next = 10;\n                      return _regeneratorRuntime.awrap(onUpload(base64));\n\n                    case 10:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }));\n\n          case 4:\n            photo = _context6.sent;\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  if (startCamera) {\n    return React.createElement(Camera, {\n      style: {\n        flex: 1,\n        width: \"100%\",\n        alignItems: \"center\",\n        justifyContent: \"flex-end\"\n      },\n      ref: function ref(r) {\n        camera.current = r;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 16\n      }\n    }, React.createElement(ActionButton, {\n      style: {\n        marginBottom: 30\n      },\n      onPress: function _callee3() {\n        return _regeneratorRuntime.async(function _callee3$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return _regeneratorRuntime.awrap(takePhoto());\n\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      },\n      title: \"Take Photo\",\n      icon: React.createElement(AntDesign, {\n        name: \"camera\",\n        style: {\n          marginLeft: 5\n        },\n        size: 30,\n        color: \"black\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 121\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }));\n  }\n\n  return React.createElement(Background, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }\n  }, React.createElement(Header, {\n    style: [styles.left_align],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, \"Try it out!\"), React.createElement(FootPrint, {\n    style: styles.left_align,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, \"Use your own product in real life!\"), React.createElement(ActionButton, {\n    style: {\n      marginTop: 20\n    },\n    onPress: function onPress() {\n      return hasPermission ? openCamera() : setToast({\n        type: 'error',\n        message: \"Go to settings to enable the camera.\"\n      });\n    },\n    title: \"Open Camera\",\n    icon: React.createElement(AntDesign, {\n      name: \"camera\",\n      style: {\n        marginLeft: 5\n      },\n      size: 30,\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 189\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }), imageBase64 ? React.createElement(View, {\n    style: styles.imageContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 10\n    }\n  }, React.createElement(Image, {\n    style: {\n      width: 300,\n      height: 400,\n      marginTop: 10\n    },\n    source: {\n      uri: \"data:image/png;base64,\" + imageBase64\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  })) : null, React.createElement(View, {\n    style: styles.buttonView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, React.createElement(ActionButton, {\n    onPress: function onPress() {\n      return navigation.navigate(\"Ad\");\n    },\n    title: \"Done\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  })), React.createElement(Toast, _extends({}, toast, {\n    onDismiss: function onDismiss() {\n      return setToast({\n        value: '',\n        type: toast.type\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  left_align: {\n    alignSelf: \"flex-start\",\n    marginLeft: 10,\n    marginVertical: 5\n  },\n  logo: {\n    marginVertical: 50\n  },\n  buttonView: {\n    flex: 1,\n    width: \"100%\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\"\n  },\n  imageContainer: {\n    margin: 30,\n    flex: 1,\n    width: '100%',\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["/Users/Bhavesh/Developer/AI_CAMP/ai-on-thumbs/screens/Try.js"],"names":["React","useEffect","useState","useRef","Background","Logo","Header","FootPrint","ActionButton","AntDesign","Camera","Toast","FileSystem","axios","require","MediaLibrary","Permissions","manipulateAsync","SaveFormat","Try","navigation","hasPermission","setHasPermission","Constants","Type","back","type","setType","value","toast","setToast","startCamera","setStartCamera","imageBase64","setImageBase64","camera","loading","setLoading","onUpload","text","sendFaceRequest","data","compressImage","uri","format","JPEG","resize","width","compress","result","image_string","fetch","method","body","JSON","stringify","base_64","headers","res","console","log","error","response","requestPermissionsAsync","status","justifyContent","openCamera","takePhoto","current","takePictureAsync","then","photo","readAsStringAsync","encoding","base64","length","flex","alignItems","r","marginBottom","marginLeft","styles","left_align","marginTop","message","imageContainer","height","buttonView","navigate","StyleSheet","create","alignSelf","marginVertical","logo","margin"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,EAAoCC,MAApC,QAAiD,OAAjD;;;;;;AAEA,OAAOC,UAAP;AACA,OAAOC,IAAP;AACA,OAAOC,MAAP;AACA,OAAOC,SAAP;AACA,OAAOC,YAAP;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,MAAT,QAAuB,aAAvB;AACA,OAAOC,KAAP;AACA,OAAO,KAAKC,UAAZ,MAA4B,kBAA5B;;AACA,IAAMC,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,OAAO,KAAKC,YAAZ,MAA8B,oBAA9B;AACA,OAAO,KAAKC,WAAZ,MAA6B,kBAA7B;AACA,SAASC,eAAT,EAA0BC,UAA1B,QAA4C,wBAA5C;AAGA,eAAe,SAASC,GAAT,OAA2B;AAAA,MAAbC,UAAa,QAAbA,UAAa;;AACxC,kBAA0ClB,QAAQ,CAAC,IAAD,CAAlD;AAAA;AAAA,MAAOmB,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,mBAAwBpB,QAAQ,CAACQ,MAAM,CAACa,SAAP,CAAiBC,IAAjB,CAAsBC,IAAvB,CAAhC;AAAA;AAAA,MAAOC,IAAP;AAAA,MAAaC,OAAb;;AACA,mBAA0BzB,QAAQ,CAAC;AAAE0B,IAAAA,KAAK,EAAE,EAAT;AAAaF,IAAAA,IAAI,EAAE;AAAnB,GAAD,CAAlC;AAAA;AAAA,MAAOG,KAAP;AAAA,MAAcC,QAAd;;AACA,mBAAqC5B,QAAQ,CAAC,KAAD,CAA7C;AAAA;AAAA,MAAO6B,WAAP;AAAA,MAAmBC,cAAnB;;AACA,mBAAsC9B,QAAQ,CAAC,IAAD,CAA9C;AAAA;AAAA,MAAO+B,WAAP;AAAA,MAAoBC,cAApB;;AACA,MAAMC,MAAM,GAAGhC,MAAM,CAAC,IAAD,CAArB;;AACA,oBAA8BD,QAAQ,CAAC,IAAD,CAAtC;AAAA;AAAA,MAAOkC,OAAP;AAAA,MAAgBC,UAAhB;;AAEA,MAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACIC,eAAe,CAACD,IAAD,CADnB;;AAAA;AACTE,YAAAA,IADS;AAEfP,YAAAA,cAAc,CAACO,IAAD,CAAd;;AAFe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAIA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAYC,YAAAA,MAAZ,8DAAqB1B,UAAU,CAAC2B,IAAhC;AAAA;AAAA,6CACC5B,eAAe,CAChC0B,GADgC,EAEhC,CAAC;AAAEG,cAAAA,MAAM,EAAE;AAAEC,gBAAAA,KAAK,EAAE;AAAT;AAAV,aAAD,CAFgC,EAGhC;AAAEC,cAAAA,QAAQ,EAAE,GAAZ;AAAiBJ,cAAAA,MAAM,EAANA;AAAjB,aAHgC,CADhB;;AAAA;AACdK,YAAAA,MADc;AAAA,8CAOZA,MAAM,CAACN,GAPK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtB;;AAUA,MAAMH,eAAe,GAAG,SAAlBA,eAAkB,CAAOU,YAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CAGJC,KAAK,CAAC,yCAAD,EACrB;AAACC,cAAAA,MAAM,EAAE,MAAT;AACAC,cAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,gBAAAA,OAAO,EAAEN;AADU,eAAf,CADN;AAIAO,cAAAA,OAAO,EAAE;AACP,gCAAgB;AADT;AAJT,aADqB,CAHD;;AAAA;AAGhBC,YAAAA,GAHgB;AAAA;AAAA;;AAAA;AAAA;AAAA;AAahBC,YAAAA,OAAO,CAACC,GAAR,CAAYC,KAAK,CAACC,QAAN,CAAerB,IAA3B;;AAbgB;AAAA;AAAA,6CAiBHiB,GAAG,CAACnB,IAAJ,EAjBG;;AAAA;AAiBhBE,YAAAA,IAjBgB;AAAA,8CAmBbA,IAnBa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAxB;;AAsBAxC,EAAAA,SAAS,CAAC,YAAM;AACV,KAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CACwBS,MAAM,CAACqD,uBAAP,EADxB;;AAAA;AAAA;AACOC,cAAAA,MADP,yBACOA,MADP;AAED1C,cAAAA,gBAAgB,CAAC0C,MAAM,KAAK,SAAZ,CAAhB;;AAFC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AAIH,GALM,EAKJ,EALI,CAAT;;AAOE,MAAI3C,aAAa,KAAK,IAAtB,EAA4B;AACxB,WAAO,oBAAC,UAAD;AAAY,MAAA,KAAK,EAAE;AAAC4C,QAAAA,cAAc,EAAC;AAAhB,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA8C,oBAAC,iBAAD;AAAmB,MAAA,IAAI,EAAE,GAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA9C,CAAP;AACH;;AACD,WAASC,UAAT,GAAqB;AACjBlC,IAAAA,cAAc,CAAC,IAAD,CAAd;AACH;;AACD,WAAemC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACahC,MAAM,CAACiC,OADpB;AAAA;AAAA;AAAA;;AAAA,8CAEe,IAFf;;AAAA;AAAA;AAAA,6CAI4BjC,MAAM,CAACiC,OAAP,CAAeC,gBAAf,GAAkCC,IAAlC,CAAuC,kBAAMC,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAEvDvC,sBAAAA,cAAc,CAAC,KAAD,CAAd;AAFuD;AAAA,uDAGpCU,aAAa,CAAC6B,KAAK,CAAC5B,GAAP,CAHuB;;AAAA;AAGjDA,sBAAAA,GAHiD;AAAA;AAAA,uDAIlC/B,UAAU,CAAC4D,iBAAX,CAA6B7B,GAA7B,EAAkC;AAAE8B,wBAAAA,QAAQ,EAAE;AAAZ,uBAAlC,CAJkC;;AAAA;AAIjDC,sBAAAA,MAJiD;AAKvDf,sBAAAA,OAAO,CAACC,GAAR,CAAYc,MAAM,CAACC,MAAnB;AALuD;AAAA,uDAMjDrC,QAAQ,CAACoC,MAAD,CANyC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAvC,CAJ5B;;AAAA;AAIcH,YAAAA,KAJd;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAeA,MAAGxC,WAAH,EAAe;AACX,WAAO,oBAAC,MAAD;AACP,MAAA,KAAK,EAAE;AAAC6C,QAAAA,IAAI,EAAE,CAAP;AAAS7B,QAAAA,KAAK,EAAC,MAAf;AAAuB8B,QAAAA,UAAU,EAAC,QAAlC;AAA4CZ,QAAAA,cAAc,EAAC;AAA3D,OADA;AAEP,MAAA,GAAG,EAAE,aAACa,CAAD,EAAO;AACZ3C,QAAAA,MAAM,CAACiC,OAAP,GAAiBU,CAAjB;AACC,OAJM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAMH,oBAAC,YAAD;AAAc,MAAA,KAAK,EAAE;AAACC,QAAAA,YAAY,EAAC;AAAd,OAArB;AAAwC,MAAA,OAAO,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAAkBZ,SAAS,EAA3B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAjD;AAAiF,MAAA,KAAK,EAAE,YAAxF;AAAsG,MAAA,IAAI,EAAE,oBAAC,SAAD;AAAW,QAAA,IAAI,EAAC,QAAhB;AAAyB,QAAA,KAAK,EAAE;AAACa,UAAAA,UAAU,EAAC;AAAZ,SAAhC;AAAgD,QAAA,IAAI,EAAE,EAAtD;AAA0D,QAAA,KAAK,EAAC,OAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAA5G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANG,CAAP;AAQH;;AACH,SACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAG,CAACC,MAAM,CAACC,UAAR,CAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ,EAEI,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAED,MAAM,CAACC,UAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAFJ,EAGI,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAE;AAACC,MAAAA,SAAS,EAAC;AAAX,KAArB;AAAqC,IAAA,OAAO,EAAE;AAAA,aAAI9D,aAAa,GAAC6C,UAAU,EAAX,GAAcpC,QAAQ,CAAC;AAAEJ,QAAAA,IAAI,EAAE,OAAR;AAAiB0D,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAAvC;AAAA,KAA9C;AAA0J,IAAA,KAAK,EAAC,aAAhK;AAA8K,IAAA,IAAI,EAAE,oBAAC,SAAD;AAAW,MAAA,IAAI,EAAC,QAAhB;AAAyB,MAAA,KAAK,EAAE;AAACJ,QAAAA,UAAU,EAAC;AAAZ,OAAhC;AAAgD,MAAA,IAAI,EAAE,EAAtD;AAA0D,MAAA,KAAK,EAAC,OAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAApL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,EAIM/C,WAAW,GACZ,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEgD,MAAM,CAACI,cAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAE;AAACtC,MAAAA,KAAK,EAAE,GAAR;AAAauC,MAAAA,MAAM,EAAE,GAArB;AAA0BH,MAAAA,SAAS,EAAC;AAApC,KAAd;AAAuD,IAAA,MAAM,EAAE;AAACxC,MAAAA,GAAG,6BAA2BV;AAA/B,KAA/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADH,CADY,GAGL,IAPZ,EASI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEgD,MAAM,CAACM,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,YAAD;AAAc,IAAA,OAAO,EAAE;AAAA,aAAInE,UAAU,CAACoE,QAAX,CAAoB,IAApB,CAAJ;AAAA,KAAvB;AAAsD,IAAA,KAAK,EAAC,MAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CATJ,EAYI,oBAAC,KAAD,eAAW3D,KAAX;AAAkB,IAAA,SAAS,EAAE;AAAA,aAAMC,QAAQ,CAAC;AAAEF,QAAAA,KAAK,EAAE,EAAT;AAAaF,QAAAA,IAAI,EAAEG,KAAK,CAACH;AAAzB,OAAD,CAAd;AAAA,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAZJ,CADF;AAgBD;AAED,IAAMuD,MAAM,GAAGQ,UAAU,CAACC,MAAX,CAAkB;AAC7BR,EAAAA,UAAU,EAAC;AACPS,IAAAA,SAAS,EAAC,YADH;AAEPX,IAAAA,UAAU,EAAC,EAFJ;AAGPY,IAAAA,cAAc,EAAC;AAHR,GADkB;AAM7BC,EAAAA,IAAI,EAAC;AACHD,IAAAA,cAAc,EAAE;AADb,GANwB;AAS7BL,EAAAA,UAAU,EAAC;AACPX,IAAAA,IAAI,EAAC,CADE;AAEP7B,IAAAA,KAAK,EAAC,MAFC;AAGPkB,IAAAA,cAAc,EAAC,UAHR;AAIPY,IAAAA,UAAU,EAAC;AAJJ,GATkB;AAe7BQ,EAAAA,cAAc,EAAC;AACXS,IAAAA,MAAM,EAAC,EADI;AAEXlB,IAAAA,IAAI,EAAC,CAFM;AAGX7B,IAAAA,KAAK,EAAC,MAHK;AAIX8B,IAAAA,UAAU,EAAC;AAJA;AAfc,CAAlB,CAAf","sourcesContent":["import React, {useEffect, useState, useRef} from 'react';\nimport { StyleSheet, Text, View, ActivityIndicator, Image } from 'react-native';\nimport Background from '../components/Background';\nimport Logo from '../components/Logo';\nimport Header from '../components/Header';\nimport FootPrint from '../components/FootPrint';\nimport ActionButton from \"../components/ActionButton\";\nimport { AntDesign } from '@expo/vector-icons';\nimport { Camera } from 'expo-camera';\nimport Toast from '../components/Toast';\nimport * as FileSystem from 'expo-file-system';\nconst axios = require(\"axios\");\nimport * as MediaLibrary from 'expo-media-library';\nimport * as Permissions from 'expo-permissions';\nimport { manipulateAsync, SaveFormat } from 'expo-image-manipulator';    \n\n\nexport default function Try({navigation}) {\n  const [hasPermission, setHasPermission] = useState(null);\n  const [type, setType] = useState(Camera.Constants.Type.back);\n  const [toast, setToast] = useState({ value: '', type: '' })\n  const [startCamera,setStartCamera] = useState(false);\n  const [imageBase64, setImageBase64] = useState(null);\n  const camera = useRef(null)\n  const [loading, setLoading] = useState(true)\n\n  const onUpload = async (text) => {\n    const data = await sendFaceRequest(text)\n    setImageBase64(data)\n  }\n  const compressImage = async (uri, format = SaveFormat.JPEG) => {\n    const result = await manipulateAsync(\n        uri,\n        [{ resize: { width: 250 } }],\n        { compress: 0.7, format }\n    );\n\n    return  result.uri;\n    // return: { name, type, width, height, uri }\n};\n  const sendFaceRequest = async (image_string) => {\n\n      try{\n      var res = await fetch(\"https://rohanjoshi2.herokuapp.com/image\", \n      {method: 'POST',\n      body: JSON.stringify({\n        base_64: image_string\n      }),\n      headers: {\n        'Content-type': 'application/json'\n      }\n    })\n      } catch {\n          console.log(error.response.data);     // NOTE - use \"error.response.data` (not \"error\")\n      }\n\n      // var data = await res.data\n      var data = await res.text()\n      //console.log(data)\n      return data\n  }\n\n  useEffect(() => {\n        (async () => {\n        const { status } = await Camera.requestPermissionsAsync();\n        setHasPermission(status === 'granted');\n        })();\n    }, []);\n\n    if (hasPermission === null) {\n        return <Background style={{justifyContent:\"center\"}}><ActivityIndicator size={100}/></Background>;\n    }\n    function openCamera(){\n        setStartCamera(true)\n    }\n    async function takePhoto(){\n            if (!camera.current){ \n            return null;\n            }\n            const photo = await camera.current.takePictureAsync().then(async photo=>\n              {\n                setStartCamera(false);\n                const uri  = await compressImage(photo.uri);\n                const base64 = await FileSystem.readAsStringAsync(uri, { encoding: 'base64' });\n                console.log(base64.length)\n                await onUpload(base64);\n              });\n            \n            \n    }\n    if(startCamera){\n        return(<Camera\n        style={{flex: 1,width:\"100%\", alignItems:\"center\", justifyContent:\"flex-end\"}}\n        ref={(r) => {\n        camera.current = r\n        }}\n        >\n            <ActionButton style={{marginBottom:30}} onPress={async ()=> {await takePhoto()}} title={\"Take Photo\"} icon={<AntDesign name=\"camera\" style={{marginLeft:5}} size={30} color=\"black\" />}/>\n        </Camera>)\n    }\n  return (\n    <Background>\n        <Header style= {[styles.left_align]}>Try it out!</Header>\n        <FootPrint style={styles.left_align}>Use your own product in real life!</FootPrint>\n        <ActionButton style={{marginTop:20}} onPress={()=>hasPermission?openCamera():setToast({ type: 'error', message: \"Go to settings to enable the camera.\"})} title=\"Open Camera\" icon={<AntDesign name=\"camera\" style={{marginLeft:5}} size={30} color=\"black\" />}/>\n         {imageBase64?\n         <View style={styles.imageContainer}>\n            <Image style={{width: 300, height: 400, marginTop:10}} source={{uri: `data:image/png;base64,${imageBase64}`}}/>\n        </View>:null}\n        \n        <View style={styles.buttonView}>\n            <ActionButton onPress={()=>navigation.navigate(\"Ad\")} title=\"Done\"/>\n        </View>\n        <Toast {...toast} onDismiss={() => setToast({ value: '', type: toast.type })} />\n    </Background>\n  );\n}\n\nconst styles = StyleSheet.create({\n    left_align:{\n        alignSelf:\"flex-start\",\n        marginLeft:10,\n        marginVertical:5,\n    },\n    logo:{\n      marginVertical: 50,\n    },\n    buttonView:{\n        flex:1,\n        width:\"100%\",\n        justifyContent:\"flex-end\",\n        alignItems:\"center\"\n    },\n    imageContainer:{\n        margin:30,\n        flex:1,\n        width:'100%',\n        alignItems:\"center\",\n    }\n});\n"]},"metadata":{},"sourceType":"module"}